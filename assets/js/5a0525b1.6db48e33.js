"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[2562],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return d}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=r.createContext({}),u=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},s=function(e){var n=u(e.components);return r.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},k=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,l=e.originalType,i=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),k=u(t),d=o,m=k["".concat(i,".").concat(d)]||k[d]||p[d]||l;return t?r.createElement(m,a(a({ref:n},s),{},{components:t})):r.createElement(m,a({ref:n},s))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=t.length,a=new Array(l);a[0]=k;var c={};for(var i in n)hasOwnProperty.call(n,i)&&(c[i]=n[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var u=2;u<l;u++)a[u]=t[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}k.displayName="MDXCreateElement"},3120:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return c},contentTitle:function(){return i},metadata:function(){return u},assets:function(){return s},toc:function(){return p},default:function(){return d}});var r=t(7462),o=t(3366),l=(t(7294),t(3905)),a=["components"],c={slug:"linux-install-docker",title:"Linux\u642d\u5efaDocker\u73af\u5883",authors:"zeffon",tags:["linux","docker"],date:new Date("2019-09-10T00:00:00.000Z")},i=void 0,u={permalink:"/blog/linux-install-docker",editUrl:"https://github.com/zeffon/zeffon.github.io/blob/master/blog/2019/2019-09-10-linux-install-docker.md",source:"@site/blog/2019/2019-09-10-linux-install-docker.md",title:"Linux\u642d\u5efaDocker\u73af\u5883",description:"Docker \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5e94\u7528\u5bb9\u5668\u5f15\u64ce\uff0c\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u6253\u5305\u4ed6\u4eec\u7684\u5e94\u7528\u4ee5\u53ca\u4f9d\u8d56\u5305\u5230\u4e00\u4e2a\u53ef\u79fb\u690d\u7684\u955c\u50cf\u4e2d\uff0c\u7136\u540e\u53d1\u5e03\u5230\u4efb\u4f55\u6d41\u884c\u7684 Linux \u6216 Windows \u673a\u5668\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u5316\u3002\u5bb9\u5668\u662f\u5b8c\u5168\u4f7f\u7528\u6c99\u7bb1\u673a\u5236\uff0c\u76f8\u4e92\u4e4b\u95f4\u4e0d\u4f1a\u6709\u4efb\u4f55\u63a5\u53e3\u3002",date:"2019-09-10T00:00:00.000Z",formattedDate:"September 10, 2019",tags:[{label:"linux",permalink:"/blog/tags/linux"},{label:"docker",permalink:"/blog/tags/docker"}],readingTime:1.835,truncated:!0,authors:[{name:"Zeffon Wu",title:"A web engineer",url:"https://github.com/zeffon",imageURL:"https://github.com/zeffon.png",key:"zeffon"}],prevItem:{title:"Docker\u90e8\u7f72Java\u9879\u76ee",permalink:"/blog/docker-deploy-jar"},nextItem:{title:"\u514d\u8d39https\u901a\u914d\u7b26\u8bc1\u4e66\u7533\u8bf7\u4e0e\u914d\u7f6e",permalink:"/blog/how-apply-https"}},s={authorsImageUrls:[void 0]},p=[{value:"\u524d\u8a00",id:"\u524d\u8a00",children:[]},{value:"\u524d\u7f6e\u6761\u4ef6",id:"\u524d\u7f6e\u6761\u4ef6",children:[{value:"\u7248\u672c\u95ee\u9898\u548c\u5378\u8f7d\u65e7\u7248\u672c",id:"\u7248\u672c\u95ee\u9898\u548c\u5378\u8f7d\u65e7\u7248\u672c",children:[]}]},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",children:[{value:"\u5b89\u88c5\u5305\u548c\u5176\u4ed6\u9a71\u52a8\u4f9d\u8d56",id:"\u5b89\u88c5\u5305\u548c\u5176\u4ed6\u9a71\u52a8\u4f9d\u8d56",children:[]}]},{value:"Docker \u7684\u4f7f\u7528",id:"docker-\u7684\u4f7f\u7528",children:[{value:"\u542f\u52a8\u4e0e\u9a8c\u8bc1",id:"\u542f\u52a8\u4e0e\u9a8c\u8bc1",children:[]},{value:"Docker \u66f4\u65b0\u548c\u5378\u8f7d",id:"docker-\u66f4\u65b0\u548c\u5378\u8f7d",children:[]}]},{value:"\u5b89\u88c5 docker-compose",id:"\u5b89\u88c5-docker-compose",children:[{value:"<code>CURL</code>\u5b89\u88c5\u51fa\u9519",id:"curl\u5b89\u88c5\u51fa\u9519",children:[]},{value:"<code>\u5b89\u88c5\u5305</code>\u624b\u52a8\u4e0b\u8f7d",id:"\u5b89\u88c5\u5305\u624b\u52a8\u4e0b\u8f7d",children:[]}]}],k={toc:p};function d(e){var n=e.components,t=(0,o.Z)(e,a);return(0,l.kt)("wrapper",(0,r.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Docker \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5e94\u7528\u5bb9\u5668\u5f15\u64ce\uff0c\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u6253\u5305\u4ed6\u4eec\u7684\u5e94\u7528\u4ee5\u53ca\u4f9d\u8d56\u5305\u5230\u4e00\u4e2a\u53ef\u79fb\u690d\u7684\u955c\u50cf\u4e2d\uff0c\u7136\u540e\u53d1\u5e03\u5230\u4efb\u4f55\u6d41\u884c\u7684 Linux \u6216 Windows \u673a\u5668\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u5316\u3002\u5bb9\u5668\u662f\u5b8c\u5168\u4f7f\u7528\u6c99\u7bb1\u673a\u5236\uff0c\u76f8\u4e92\u4e4b\u95f4\u4e0d\u4f1a\u6709\u4efb\u4f55\u63a5\u53e3\u3002"),(0,l.kt)("h2",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,l.kt)("p",null,"Docker \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5e94\u7528\u5bb9\u5668\u5f15\u64ce\uff0c\u8ba9\u5f00\u53d1\u8005\u53ef\u4ee5\u6253\u5305\u4ed6\u4eec\u7684\u5e94\u7528\u4ee5\u53ca\u4f9d\u8d56\u5305\u5230\u4e00\u4e2a\u53ef\u79fb\u690d\u7684\u955c\u50cf\u4e2d\uff0c\u7136\u540e\u53d1\u5e03\u5230\u4efb\u4f55\u6d41\u884c\u7684 Linux \u6216 Windows \u673a\u5668\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u5316\u3002\u5bb9\u5668\u662f\u5b8c\u5168\u4f7f\u7528\u6c99\u7bb1\u673a\u5236\uff0c\u76f8\u4e92\u4e4b\u95f4\u4e0d\u4f1a\u6709\u4efb\u4f55\u63a5\u53e3\u3002"),(0,l.kt)("h2",{id:"\u524d\u7f6e\u6761\u4ef6"},"\u524d\u7f6e\u6761\u4ef6"),(0,l.kt)("h3",{id:"\u7248\u672c\u95ee\u9898\u548c\u5378\u8f7d\u65e7\u7248\u672c"},"\u7248\u672c\u95ee\u9898\u548c\u5378\u8f7d\u65e7\u7248\u672c"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"64-bit \u7cfb\u7edf kernel 3.10+")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u68c0\u67e5\u5185\u6838\u7248\u672c\uff0c\u8fd4\u56de\u7684\u503c\u5927\u4e8e 3.10 \u5373\u53ef\u3002")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ uname -r\n3.10.0-693.el7.x86_64 # 64-bit \u7cfb\u7edf kernel 3.10+\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u4f7f\u7528 sudo \u6216 root \u6743\u9650\u7684\u7528\u6237\u767b\u5165\u7ec8\u7aef\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u5378\u8f7d\u65e7\u7248\u672c(\u5982\u679c\u5b89\u88c5\u8fc7\u65e7\u7248\u672c\u7684\u8bdd)")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum remove docker \\\n      docker-common \\\n      docker-selinux \\\n      docker-engine\n")),(0,l.kt)("h2",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,l.kt)("h3",{id:"\u5b89\u88c5\u5305\u548c\u5176\u4ed6\u9a71\u52a8\u4f9d\u8d56"},"\u5b89\u88c5\u5305\u548c\u5176\u4ed6\u9a71\u52a8\u4f9d\u8d56"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5\u9700\u8981\u7684\u8f6f\u4ef6\u5305\u9a71\u52a8\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum install -y yum-utils \\\n  device-mapper-persistent-data \\\n  lvm2\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u8bbe\u7f6e yum \u6e90")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n")),(0,l.kt)("p",null,"1.\u5b89\u88c5 docker"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u7b2c\u4e00\u79cd"),": \u76f4\u63a5\u5b89\u88c5\u6700\u65b0\u672c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum install -y docker-ce\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u7b2c\u4e8c\u79cd"),": \u5b89\u88c5\u6307\u5b9a\u7248\u672c\n\u67e5\u8be2\u7248\u672c\u5217\u8868")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum list docker-ce --showduplicates | sort -r\ndocker-ce.x86_64            3:19.03.1-3.el7                    docker-ce-stable\ndocker-ce.x86_64            18.03.1.ce-1.el7.centos            docker-ce-stable\ndocker-ce.x86_64            18.03.0.ce-1.el7.centos            docker-ce-stable\ndocker-ce.x86_64            17.12.1.ce-1.el7.centos            docker-ce-stable\n")),(0,l.kt)("p",null,"\u6307\u5b9a\u7248\u672c\u5b89\u88c5(\u8fd9\u91cc\u7684\u4f8b\u5b50\u662f\u5b89\u88c5\u4e0a\u9762\u5217\u8868\u4e2d\u7684\u7b2c\u4e00\u4e2a)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ yum install -y docker-ce-3:19.03.1\n")),(0,l.kt)("h2",{id:"docker-\u7684\u4f7f\u7528"},"Docker \u7684\u4f7f\u7528"),(0,l.kt)("h3",{id:"\u542f\u52a8\u4e0e\u9a8c\u8bc1"},"\u542f\u52a8\u4e0e\u9a8c\u8bc1"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u542f\u52a8 docker \u670d\u52a1")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ sudo systemctl start docker\n$ sudo systemctl enable docker # \u5982\u679c\u60f3\u6dfb\u52a0\u5230\u5f00\u673a\u542f\u52a8\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u9a8c\u8bc1\u5b89\u88c5\u662f\u5426\u6210\u529f(\u6709 client \u548c service \u4e24\u90e8\u5206\u8868\u793a docker \u5b89\u88c5\u542f\u52a8\u90fd\u6210\u529f\u4e86)```yml\n$ docker version\nVersion: 19.03.1\nAPI version: 1.40\nGo version: go1.12.5\nGit commit: 74b1e89\nBuilt: Thu Jul 25 21:21:07 2019\nOS/Arch: linux/amd64\nExperimental: false")),(0,l.kt)("p",null,"Server: Docker Engine - Community\nEngine:\nVersion: 19.03.1\nAPI version: 1.40 (minimum version 1.12)\nGo version: go1.12.5\nGit commit: 74b1e89\nBuilt: Thu Jul 25 21:19:36 2019\nOS/Arch: linux/amd64\nExperimental: false\ncontainerd:\nVersion: 1.2.6\nGitCommit: 894b81a4b802e4eb2a91d1ce216b8817763c29fb\nrunc:\nVersion: 1.0.0-rc8\nGitCommit: 425e105d5a03fabd737a126ad93d62a9eeede87f\ndocker-init:\nVersion: 0.18.0\nGitCommit: fec3683"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'\n\n\n\n### Docker \u955c\u50cf\u52a0\u901f\u5730\u5740\n\n\n1. \u6dfb\u52a0\u7f16\u8f91daemon.json\n\n\n\n```sh\n$ vim /etc/docker/daemon.json\n{\n    "registry-mirrors": ["https://fy707np5.mirror.aliyuncs.com"]\n}\n')),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u91cd\u65b0\u52a0\u8f7d\u5e76",(0,l.kt)("inlineCode",{parentName:"li"},"\u91cd\u542f"),"Docker")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ systemctl daemon-reload\n$ systemctl restart docker\n")),(0,l.kt)("h3",{id:"docker-\u66f4\u65b0\u548c\u5378\u8f7d"},"Docker \u66f4\u65b0\u548c\u5378\u8f7d"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u66f4\u65b0 Docker CE")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ sudo yum update docker-ce\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5378\u8f7d Docker CE")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ sudo yum remove docker-ce\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5220\u9664\u672c\u5730\u6587\u4ef6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ sudo rm -rf /var/lib/docker\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u6ce8\u610f"))," docker \u7684\u672c\u5730\u6587\u4ef6\uff0c\u5305\u62ec\u955c\u50cf(images), \u5bb9\u5668(containers), \u5b58\u50a8\u5377(volumes)\u7b49\uff0c\u90fd\u9700\u8981\u624b\u5de5\u5220\u9664\u3002\u9ed8\u8ba4\u76ee\u5f55\u5b58\u50a8\u5728 \xa0/var/lib/docker\u3002")),(0,l.kt)("h2",{id:"\u5b89\u88c5-docker-compose"},"\u5b89\u88c5 docker-compose"),(0,l.kt)("h3",{id:"curl\u5b89\u88c5\u51fa\u9519"},(0,l.kt)("inlineCode",{parentName:"h3"},"CURL"),"\u5b89\u88c5\u51fa\u9519"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6309\u7167\u5b98\u65b9\u6587\u6863\uff0c\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"strong"},"curl"),"\u65b9\u5f0f\u5b89\u88c5",(0,l.kt)("inlineCode",{parentName:"strong"},"docker-compose"),"\u540e\uff0c\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f\u65f6\u51fa\u9519")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5\u65f6\u4f7f\u7528\u7684\u547d\u4ee4")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"curl -L https://github.com/docker/compose/releases/download/1.14.0-rc2/docker-compose-`uname -s`-`ur/local/bin/docker-compose\nchmod +x /usr/local/bin/docker-compose\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5982\u679c\u542f\u52a8\u65f6\u62a5\u5982\u4e0b\u9519\u8bef,\u8bf4\u660e curl \u5b89\u88c5\u65b9\u5f0f\u4e0b\u8f7d\u7684\u5305\u4e0d\u5b8c\u6574\u3002\n","[1814]"," Cannot open self /usr/local/bin/docker-compose or archive /usr/local/bin/docker-compose.pkg")),(0,l.kt)("h3",{id:"\u5b89\u88c5\u5305\u624b\u52a8\u4e0b\u8f7d"},(0,l.kt)("inlineCode",{parentName:"h3"},"\u5b89\u88c5\u5305"),"\u624b\u52a8\u4e0b\u8f7d"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u8fdb\u5165",(0,l.kt)("a",{parentName:"li",href:"https://github.com/docker/compose/releases"},"\u5b98\u7f51"),", \u9009\u62e9\u6700\u65b0\u7248\u624b\u52a8\u4e0b\u8f7d\u3002\u5f53\u524d\u6700\u65b0",(0,l.kt)("inlineCode",{parentName:"li"},"1.25.0-rc2"),"\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose-Linux-x86_64")),(0,l.kt)("li",{parentName:"ol"},"\u7136\u540e\u5c06\u6587\u4ef6\u4e0a\u4f20\u5230",(0,l.kt)("inlineCode",{parentName:"li"},"/usr/local/bin/ \u6587\u4ef6\u5939\u4e0b"),"\uff0c\u7136\u540e\u5c06\u5176\u91cd\u547d\u540d\u4e3a",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose"),"\uff0c\u4fee\u6539\u6b64\u6587\u4ef6\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"\u6743\u9650"),"\uff0c\u589e\u52a0\u53ef\u6267\u884c\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"chmod +x /usr/local/bin/docker-compose\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u7136\u540e\u518d\u8fd0\u884c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ docker-compose version\ndocker-compose version 1.25.0-rc2, build 661ac20e\ndocker-py version: 4.0.1\nCPython version: 3.7.4\nOpenSSL version: OpenSSL 1.1.0k  28 May 2019\n")))}d.isMDXComponent=!0}}]);